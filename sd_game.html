<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>簡單黑色沙漠示範</title>
<style>
  body, html { margin:0; padding:0; background:#000; overflow:hidden; }
  canvas { display:block; margin:auto; background:#222; }
</style>
</head>
<body>
<canvas id="gameCanvas" width="480" height="640"></canvas>
<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

let player = {x: canvas.width/2, y: canvas.height-60, w:40, h:40, hp:100};
let enemies = [];
let bullets = [];
let score = 0;

// 玩家鍵盤控制
let keys = {};
document.addEventListener("keydown", e=> keys[e.key]=true);
document.addEventListener("keyup", e=> keys[e.key]=false);

// 生成敵人
function spawnEnemy(){
    let x = Math.random()*(canvas.width-40);
    enemies.push({x, y:-40, w:40, h:40, hp:30, speed:2});
}
setInterval(spawnEnemy, 1500);

// 發射子彈
function shoot(){
    bullets.push({x: player.x+player.w/2-5, y:player.y, w:10, h:20, speed:6});
}
document.addEventListener("keydown", e=>{
    if(e.key===" ") shoot();
});

// 遊戲更新
function update(){
    // 玩家移動
    if(keys["ArrowLeft"]) player.x -=5;
    if(keys["ArrowRight"]) player.x +=5;
    if(player.x<0) player.x=0;
    if(player.x>canvas.width-player.w) player.x=canvas.width-player.w;

    // 子彈移動
    bullets.forEach((b,i)=>{
        b.y -= b.speed;
        // 子彈碰撞敵人
        enemies.forEach((en,ei)=>{
            if(b.x<b.x+b.w && b.x+b.w>en.x && b.y<b.y+b.h && b.y+b.h>en.y){
                enemies.splice(ei,1);
                bullets.splice(i,1);
                score +=10;
            }
        });
    });

    bullets = bullets.filter(b=>b.y>0);

    // 敵人移動
    enemies.forEach((en,i)=>{
        en.y += en.speed;
        // 敵人碰到玩家
        if(en.x<player.x+player.w && en.x+en.w>player.x && en.y<player.y+player.h && en.y+en.h>player.y){
            player.hp -=10;
            enemies.splice(i,1);
        }
    });
}

// 畫面渲染
function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);

    // 玩家
    ctx.fillStyle="white";
    ctx.fillRect(player.x,player.y,player.w,player.h);

    // 子彈
    ctx.fillStyle="yellow";
    bullets.forEach(b=>ctx.fillRect(b.x,b.y,b.w,b.h));

    // 敵人
    ctx.fillStyle="red";
    enemies.forEach(en=>ctx.fillRect(en.x,en.y,en.w,en.h));

    // 血量
    ctx.fillStyle="green";
    ctx.fillRect(10,10,player.hp*2,20);
    ctx.strokeStyle="white";
    ctx.strokeRect(10,10,200,20);

    // 分數
    ctx.fillStyle="white";
    ctx.font="20px Arial";
    ctx.fillText("分數："+score, 10, 50);
}

// 遊戲主迴圈
function gameLoop(){
    update();
    draw();
    if(player.hp>0){
        requestAnimationFrame(gameLoop);
    } else {
        ctx.fillStyle="white";
        ctx.font="40px Arial";
        ctx.fillText("遊戲結束", canvas.width/2-100, canvas.height/2);
    }
}

// 開始遊戲
gameLoop();
</script>
</body>
</html>
