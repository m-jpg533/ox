<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>â›ï¸ ç¶²é ç‰ˆæŒ–ç¤¦æ¨¡æ“¬å™¨</title>
  <style>
    body {
      font-family: "Courier New", monospace;
      background-color: #111;
      color: #0f0;
      padding: 20px;
    }
    .miner {
      border: 1px solid #0f0;
      padding: 10px;
      margin-bottom: 15px;
    }
    .progress {
      height: 20px;
      background-color: #333;
      margin-top: 5px;
    }
    .bar {
      height: 100%;
      background-color: lime;
      width: 0%;
      transition: width 0.1s;
    }
    .hash {
      font-size: 0.9em;
      color: #ccc;
    }
    button {
      padding: 10px;
      background-color: #0f0;
      border: none;
      color: black;
      font-weight: bold;
      cursor: pointer;
      margin-top: 10px;
    }
  </style>
</head>
<body>

<h1>ğŸ’» ç¶²é ç‰ˆæŒ–ç¤¦æ¯”è³½æ¨¡æ“¬å™¨</h1>
<div id="miners"></div>
<button onclick="startMining()">é–‹å§‹æŒ–ç¤¦</button>

<script>
  const NUM_MINERS = 4;
  const DIFFICULTY = 4;
  const miners = [];
  let mining = false;
  const targetPrefix = "0".repeat(DIFFICULTY);

  function createMiner(index) {
    const container = document.createElement("div");
    container.className = "miner";
    container.innerHTML = `
      <h3>ç¤¦å·¥ ${index + 1} â›ï¸</h3>
      <div>é€Ÿåº¦ï¼š<span id="speed${index}">0</span> hash/s</div>
      <div>ç›®å‰ hashï¼š<span id="hash${index}" class="hash">N/A</span></div>
      <div class="progress"><div id="bar${index}" class="bar"></div></div>
      <div id="status${index}">ç‹€æ…‹ï¼šå¾…å‘½</div>
    `;
    document.getElementById("miners").appendChild(container);

    return {
      id: index,
      speedElem: document.getElementById(`speed${index}`),
      hashElem: document.getElementById(`hash${index}`),
      barElem: document.getElementById(`bar${index}`),
      statusElem: document.getElementById(`status${index}`),
      nonce: 0,
      running: false
    };
  }

  function fakeHash(input) {
    const chars = "abcdef0123456789";
    return Array.from({ length: 64 }, () => chars[Math.floor(Math.random() * chars.length)]).join('');
  }

  function startMining() {
    if (mining) return;
    mining = true;
    document.getElementById("miners").innerHTML = "";

    for (let i = 0; i < NUM_MINERS; i++) {
      miners[i] = createMiner(i);
    }

    for (let miner of miners) {
      miner.running = true;
      miner.statusElem.textContent = "ç‹€æ…‹ï¼šæŒ–ç¤¦ä¸­...";
      let count = 0;
      let lastTime = Date.now();

      function mine() {
        if (!mining || !miner.running) return;

        const hash = fakeHash(miner.nonce);
        miner.nonce++;
        miner.hashElem.textContent = hash;
        count++;

        // æ¨¡æ“¬æ‰¾åˆ°ç¤¦
        if (hash.startsWith(targetPrefix)) {
          miner.statusElem.textContent = `ğŸ‰ æˆåŠŸæŒ–åˆ°ç¤¦ï¼nonce=${miner.nonce}`;
          miner.barElem.style.width = "100%";
          miner.running = false;
          mining = false;

          // åœæ­¢å…¶ä»–ç¤¦å·¥
          for (let m of miners) {
            if (m !== miner) {
              m.running = false;
              m.statusElem.textContent = "âŒ æ¯”è³½çµæŸ";
            }
          }

          return;
        }

        // æ›´æ–°é€Ÿåº¦
        if (Date.now() - lastTime >= 1000) {
          miner.speedElem.textContent = count;
          count = 0;
          lastTime = Date.now();
        }

        // æ¨¡æ“¬é€²åº¦æ¢ï¼ˆç´”è£é£¾ï¼‰
        miner.barElem.style.width = `${(miner.nonce % 100) + 1}%`;

        setTimeout(mine, Math.random() * 10);
      }

      mine();
    }
  }
</script>

</body>
</html>

